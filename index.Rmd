---
title: "**Visualisasi Data dengan R<br>**"
subtitle: "Kumpulan kode untuk membuat berbagai grafik <br> menggunakan bahasa pemrograman R<br><br>"
author: "*Ditulis oleh : Panggah D. Putra*"
date: "*Update terakhir : `r format(Sys.time(), '%d %B %Y')`*"
output:
  html_document:
    toc: true
    toc_float:
      collapsed: false
    toc_depth: 3
    theme: lumen
    highlight: tango
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
```

***

## **Prakata**

Website ini saya susun dalam rangka belajar visualisasi data menggunakan bahasa pemrograman R sekaligus belajar R Markdown, serta belajar lain-lain, panjang untuk disebutkan. Tentu saja, website ini masih dalam proses penyelesaian!

Jika anda membuka website ini dengan *handphone*, demi tampilan yang lebih nyaman, saya sarankan untuk menggunakan tampilan situs desktop.

***

## **Pendahuluan**

Sebelum melangkah lebih jauh, saya asumsikan anda sudah cukup memahami bahasa pemrograman R dan sudah menginstal [R](https://cran.r-project.org/) dan [Rstudio](https://www.rstudio.com/products/rstudio/#Desktop).

***

##### Klasifikasi Grafik

Grafik dalam website ini diklasifikasikan berdasarkan klasifikasi pada [Financial Times Visual Vocabulary](https://github.com/Financial-Times/chart-doctor/tree/main/visual-vocabulary){target="blank"} dengan tambahan dari berbagai sumber.

Berdasarkan <span style="color: darkblue;">**Financial Times Visual Vocabulary**</span>, grafik dibagi ke dalam beberapa tipe antara lain:

* Korelasi <br>
* Peringkat <br>
* Distribusi

***

##### Dataset

Grafik di dalam website ini dibuat dengan menggunakan beberapa dataset buatan. Sebagian besar grafik dibuat dengan menggunakan dataset `main_df`, terinsiprasi dari [flipbook_script.R](https://osf.io/vt2ny/){target="blank"} yang disebut oleh CÃ©dric Scherer dalam websitenya, [Beyond Bar and Box Plots](https://z3tt.github.io/beyond-bar-and-box-plots/#import-data){target="blank"}.

***

##### Palet Warna

Grafik di dalam website ini dibuat dengan menggunakan palet warna yang berasal dari [MetBrewer](https://github.com/BlakeRMills/MetBrewer){target="blank"}. 

***

## **Prasyarat**

Seperti yang sudah disebutkan sebelumnya, saya asumsikan anda sudah cukup memahami bahasa pemrograman R dan sudah menginstal [R](https://cran.r-project.org/) dan [Rstudio](https://www.rstudio.com/products/rstudio/#Desktop).

***

### *Install Packages*

Pertama, instal terlebih dahulu (jika belum pernah diinstal sebelumnya) *package-package* yang akan digunakan dalam membuat grafik.

`install.packages('tidyverse')`
`install.packages('datasets')`
`install.packages('gapminder')`
`install.packages('CGPfunctions')`      
`install.packages('ggbump')`             
`install.packages('ggalt')`            
`install.packages('ggdist')`            
`install.packages('ggbeeswarm')`        
`install.packages('patchwork')`        
`install.packages('ggridges')`      

***

### *Load Packages*

Selanjutnya, *load* package yang sebelumnya sudah diinstal.

```{r, message=FALSE}

library(tidyverse)    # untuk manupulasi, merapikan, & visualisasi data
library(CGPfunctions) # untuk membuat Slope Graph
library(ggbump)       # untuk membuat Bump Chart
library(ggalt)        # untuk membuat Dumbbell Plot
library(ggdist)       # untuk membuat Stat Dot Plot
library(ggbeeswarm)   # untuk membuat Beeswarm Plot
library(patchwork)    # untuk membuat Population Pyramid
library(ggridges)     # untuk membuat Stat Density Ridges Plot


```

***

### Penyiapan Dataset

Sebagian besar grafik dibuat dengan menggunakan dataset `main_df` di bawah ini. 

```{r main df}

set.seed(2000)
df1 = tibble(var = 'A', val = rnorm(n = 25, mean = 5.5, sd = 1.5))
df2 = tibble(var = 'B', val = rnorm(n = 15, mean = 4.5, sd = 1.0))
df3 = tibble(var = 'C', val = rnorm(n = 20, mean = 5.0, sd = 1.0))
df4 = tibble(var = 'D', val = rnorm(n = 10, mean = 4.0, sd = 0.5))
df5 = tibble(var = 'E', val = rnorm(n = 13, mean = 5.0, sd = 1.5))

main_df <- rbind(df1, df2, df3, df4, df5) %>%
  mutate(Variable = as_factor(var),
         value = round(val, 2)) %>%
  select(Variable, value)

```

Scatter Plot dan Bubble pada tipe grafik-korelasi dibuat menggunakan Iris Dataset. Sedangkan Column+Line Timeline, Connected Scatter Plot, serta XY Heatmap pada tipe grafik-korelasi menggunakan gapminder dataset

```{r dr for correlation, message=FALSE}

library(datasets)
data(iris)

library(gapminder)
data(gapminder)

```

Dot strip plot pada tipe grafik-peringkat dibuat dengan menggunakan dataset `df_for_rank_dotstrip` di bawah ini.

```{r df for rank dotstrip}

set.seed(2000)
dfa = tibble(var = LETTERS[seq( from = 1, to = 20 )],
             val = sample(1:100, 20), year = '2018')
dfb = tibble(var = LETTERS[seq( from = 1, to = 20 )],
             val = sample(1:100, 20), year = '2019')
dfc = tibble(var = LETTERS[seq( from = 1, to = 20 )],
             val = sample(1:100, 20), year = '2020')
dfd = tibble(var = LETTERS[seq( from = 1, to = 20 )],
             val = sample(1:100, 20), year = '2021')
dfe = tibble(var = LETTERS[seq( from = 1, to = 20 )],
             val = sample(1:100, 20), year = '2022')

df_for_rank_dotstrip <- rbind(dfa, dfb, dfc, dfd, dfe) %>%
  rename(Variable = var,
         value = val)

```

Bump chart dibuat dengan menggunakan dataset `df_for_bump` di bawah ini.

```{r df for bump}

set.seed(2021)
df_6 = tibble(team = c('A','B','C','D','E'),
              game_1 = sample(1:5),
              game_2 = sample(1:5),
              game_3 = sample(1:5),
              game_4 = sample(1:5),
              game_5 = sample(1:5))

df_for_bump <- df_6 %>%
  pivot_longer(!team, names_to = 'game', values_to = 'position') %>%
  mutate(game = as.numeric(recode(game,
                                  game_1 = 1,
                                  game_2 = 2,
                                  game_3 = 3,
                                  game_4 = 4,
                                  game_5 = 5)))

```

Slope graph dibuat dengan menggunakan dataset `df_for_slope` di bawah ini.

```{r df for slope}

df_for_slope = tibble(var = c('A','B','C','D', 'E',
                              'A','B','C','D', 'E',
                              'A','B','C','D', 'E'),
                      year = c('2010','2010','2010','2010','2010',
                               '2015','2015','2015','2015','2015',
                               '2020','2020','2020','2020','2020'),
                      val = c(10,8,6,4,2,
                              13,9,11,5,7,
                              12,13,9,7,5))

```

Population pyramid dibuat dengan menggunakan dataset `df_for_pop_pyramid` di bawah ini.

```{r df for pop pyramid}

set.seed(2000)
df1 = tibble(gender = 'Male', age = '15-20',
             value = sample((5:10), size = 1))
df2 = tibble(gender = 'Male', age = '21-25',
             value = sample((10:15), size = 1))
df3 = tibble(gender = 'Male', age = '26-30',
             value = sample((15:20), size = 1))
df4 = tibble(gender = 'Male', age = '31-35',
             value = sample((20:25), size = 1))
df5 = tibble(gender = 'Male', age = '36-40',
             value = sample((25:30), size = 1))
df6 = tibble(gender = 'Male', age = '41-45',
             value = sample((30:35), size = 1))
df7 = tibble(gender = 'Male', age = '46-50',
             value = sample((35:40), size = 1))
df8 = tibble(gender = 'Male', age = '51-55',
             value = sample((40:45), size = 1))
df9 = tibble(gender = 'Male', age = '56-60',
             value = sample((45:50), size = 1))
df10 = tibble(gender = 'Female', age = '15-20',
              value = sample((5:10), size = 1))
df11 = tibble(gender = 'Female', age = '21-25',
              value = sample((10:15), size = 1))
df12 = tibble(gender = 'Female', age = '26-30',
              value = sample((15:20), size = 1))
df13 = tibble(gender = 'Female', age = '31-35',
              value = sample((20:25), size = 1))
df14 = tibble(gender = 'Female', age = '36-40',
              value = sample((25:30), size = 1))
df15 = tibble(gender = 'Female', age = '41-45',
              value = sample((30:35), size = 1))
df16 = tibble(gender = 'Female', age = '46-50',
              value = sample((35:40), size = 1))
df17 = tibble(gender = 'Female', age = '51-55',
              value = sample((40:45), size = 1))
df18 = tibble(gender = 'Female', age = '56-60',
              value = sample((45:50), size = 1))

df_for_pop_pyramid <- rbind(df1, df2, df3, df4, df5, df6,
                            df7, df8, df9, df10, df11, df12,
                            df13, df14, df15, df16, df17, df18) %>%
  mutate(age = as.factor(age))

```

Cumulative curve dibuat dengan menggunakan dataset `df_for_cum_curve` di bawah ini.

```{r df for cum curve}

set.seed(123)
df_for_cum_curve = tibble(
  var = c('A', 'A', 'A', 'A', 'A', 'A', 'A', 'A',
          'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B'),
  year = c('2015', '2016', '2017', '2018',
           '2019', '2020', '2021', '2022',
           '2015', '2016', '2017', '2018',
           '2019', '2020', '2021', '2022'),
  val = c(sample(10:50, size = 4, replace = TRUE),
          sample(50:100, size = 4, replace = TRUE),
          sample(10:50, size = 4, replace = TRUE),
          sample(50:100, size = 4, replace = TRUE)))

df_for_cum_curve <- df_for_cum_curve %>%
  group_by(var) %>%
  mutate(cumulative_val = cumsum(val))

```

***

### Penyiapan Palet Warna
Tiap tipe grafik dibuat dengan menggunakan palet warna berbeda. Untuk mempercantik tipe grafik-korelasi, palet yang digunakan adalah `palette_corr`. Untuk mempersempit fokus latihan, kode hex disalin secara manual dari <span style="color: darkblue;">**Redon Palette**</span> di [MetBrewer](https://github.com/BlakeRMills/MetBrewer#redon){target="blank"}. Anda dapat mempelajari sendiri penggunaan palet warna pada [MetBrewer](https://github.com/BlakeRMills/MetBrewer#redon){target="blank"} tanpa harus menyalin code hex secara manual.

```{r palette for correlation}

palette_corr <-c('#75884b',
                 '#1e395f',
                 '#d8b847')

```

Untuk mempercantik tipe grafik-peringkat, palet yang digunakan adalah palet `palette_ranking`. Kode hex disalin secara manual dari <span style="color: darkblue;">**Greek Palette**</span> di [MetBrewer](https://github.com/BlakeRMills/MetBrewer#greek){target="blank"}. 

```{r palette for ranking}

palette_ranking <- c('#3c0d03',
                     '#8d1c06',
                     '#e67424',
                     '#ed9b49',
                     '#f5c34d')

```

Untuk mempercantik tipe grafik-distribusi, palet yang digunakan adalah palet `palette_distr`. Kode hex disalin secara manual dari <span style="color: darkblue;">**Isfahan1 Palette**</span> di [MetBrewer](https://github.com/BlakeRMills/MetBrewer#isfahan1){target="blank"}.

```{r palette for distribution}

palette_distr <-c('#4e3910',
                  '#845d29',
                  '#4fb6ca',
                  '#178f92',
                  '#175f5d')

```

***

### Penyiapan Tema Grafik

Tiap tipe grafik dibuat dengan menggunakan tema berbeda. Untuk mempercantik tipe grafik-korelasi, tema yang digunakan adalah tema `theme_corr` di bawah ini.
```{r}

theme_corr <- theme_minimal() +
  theme(
    plot.title = element_text(color = '#1e5a46',
                              hjust = 0.5,
                              face = 'bold'),
    plot.subtitle = element_text(color = '#1e5a46',
                                 hjust = 0.5),
    plot.caption = element_text(color = '#1e5a46',
                                hjust = 1),
    axis.title = element_text(color = '#1e5a46',
                              face = 'bold'),
    axis.text = element_text(color = '#1e5a46',
                             face = 'bold'),
    panel.background = element_rect(fill = '#FFFFFF',
                                    color = NA),
    plot.background = element_rect(fill = '#FFFFFF',
                                   color = 'lightblue')
  )

```

Untuk mempercantik tipe grafik-peringkat, tema yang digunakan adalah tema `theme_ranking` di bawah ini.

```{r theme for rangking}

theme_ranking <- theme_minimal() +
  theme(
    plot.title = element_text(color = '#3c0d03',
                              hjust = 0.5,
                              face = 'bold'),
    plot.subtitle = element_text(color = '#3c0d03',
                                 hjust = 0.5),
    plot.caption = element_text(color = '#3c0d03',
                                hjust = 1),
    axis.title = element_text(color = '#8d1c06',
                              face = 'bold'),
    axis.text = element_text(color = '#8d1c06',
                             face = 'bold'),
    panel.background = element_rect(fill = '#ffffff',
                                    color = NA),
    plot.background = element_rect(fill = '#ffffff',
                                   color = 'lightblue')
  )

```

Untuk mempercantik tipe grafik-distribusi, tema yang digunakan adalah tema `theme_distr` di bawah ini.

```{r theme for distribution}

theme_distr <- theme_minimal() +
  theme(
    plot.title = element_text(color = '#1d1f54',
                              hjust = 0.5,
                              face = 'bold'),
    plot.subtitle = element_text(color = '#1d1f54',
                                 hjust = 0.5),
    plot.caption = element_text(color = '#1d1f54',
                                hjust = 1),
    axis.title = element_text(color = '#1d1f54',
                              face = 'bold'),
    axis.text = element_text(color = '#1d1f54',
                             face = 'bold'),
    panel.background = element_rect(fill = '#FFFCDE',
                                    color = NA),
    plot.background = element_rect(fill = '#FFFCDE',
                                   color = 'lightblue')
  )

```

***

## **Korelasi**

Tipe grafik-korelasi digunakan untuk menyajikan hubungan antar variabel.

***

### Scatter Plot

```{r scatter plot}

scatter_plot <- iris %>%
  ggplot(aes(x = Sepal.Length,
             y = Sepal.Width,
             color = Species)) +
  geom_point(size = 4) +
  scale_color_manual(values = palette_corr,
                     guide = 'none') +
  theme_corr +
  xlab('Variable 1') +
  ylab('Variable 2') +
  labs(title = 'Scatter Plot',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r scatter plot print, echo=FALSE, out.width = "100%"}
scatter_plot
```

***

### Satter Plot with Linear Regression Line

Pada scatter plot juga ditambahkan garis regresi linear dari 2 variabel yang disajikan.

```{r scatter plot with linear regression line, message=FALSE, warning=FALSE}

scattet_plot_reg_line <- iris %>%
  ggplot(aes(x = Sepal.Length,
             y = Sepal.Width,
             color = Species)) +
  geom_point(size = 4) +
  geom_smooth(method = "lm",
              se = FALSE) +
  scale_color_manual(values = palette_corr,
                     guide = 'none') +
  theme_corr +
  xlab('Variable 1') +
  ylab('Variable 2') +
  labs(title = 'scatterplot with Linear Regression Line',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r scatter plot with linear regression line print, echo=FALSE, out.width = "100%"}
scattet_plot_reg_line
```

***

### Column+Line Timeline

```{r column+line timeline}

col_line_tl <- gapminder %>%
  filter(country == "Indonesia") %>%
  ggplot(aes(x = year,
             y = gdpPercap)) +
  geom_col(fill = '#d8b847') +
  geom_line(aes(x = year,
                y = lifeExp*20),
            size = 2,
            color = '#1e395f') +
  geom_text(data = gapminder %>%
              filter(country == "Indonesia",
                     year == last(year)),
            aes(x = year,
                y = lifeExp*20,
                fontface = 2,
                label = 'Life Expectancy'),
            color = '#1e395f',
            vjust = -1) +
  scale_x_continuous(limits = c(1945,2010),
                     breaks = seq(1952,2007, by = 5)) +
  scale_y_continuous(limits = c(0,4000),
                     breaks = seq(0, 4000, by = 1000)) +
  theme_corr +
  ylab('GDP Per Capita') +
  labs(title = 'Column + Line Timeline',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r column+line timeline print, echo=FALSE, out.width = "100%"}
col_line_tl
```

***

### Connceted Scatter Plot

```{r connected scatterplot}

con_scatter_plot <- gapminder %>%
  filter(country == "Indonesia") %>%
  ggplot(aes(x = lifeExp,
             y = gdpPercap)) +
  geom_path(size = 2,
            color = '#d8b847') +
  geom_point(size = 4,
             color = '#75884b') +
  geom_text(aes(label = year),
            color = '#1e395f',
            vjust = -1) +
  scale_x_continuous(limits = c(35,75),
                     breaks = seq(35,75, by = 5)) +
  scale_y_continuous(limits = c(0,4000),
                     breaks = seq(0, 4000, by = 1000)) +
  theme_corr +
  xlab('Life Expectancy') +
  ylab('GDP Per Capita') +
  labs(title = 'Connected Scatterplot',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r connected scatterplot print, echo=FALSE, out.width = "100%"}
con_scatter_plot
```

***

### Bubble

```{r bubble corellation}

bubble <- iris %>%
  filter(Species == "setosa") %>%
  ggplot(aes(x = Sepal.Length,
             y = Sepal.Width,
             color = Species,
             size = Petal.Width)) +
  geom_point(alpha = 0.8,
             color = '#1e395f') +
  scale_size_area(max_size = 25,
                  guide = 'none') +
  theme_corr +
  xlab('Variable 1') +
  ylab('Variable 2') +
  labs(title = 'Bubble',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r bubble corellation print, echo=FALSE, out.width = "100%"}
bubble
```

***

### XY Heatmap

```{r xy heatmap, message=FALSE}

xy_heatmap <- gapminder %>%
  group_by(continent, year) %>%
  summarize(MedlifeExp = round(median(lifeExp), 0)) %>%
  ggplot(aes(x = year,
             y = continent,
             fill = MedlifeExp)) +
  geom_tile(color = '#FFFFFF') +
  geom_text(aes(label = MedlifeExp),
            size = 4,
            color = '#FFFFFF') +
  scale_fill_gradient(name = 'Median Life Expectancy',low = '#75884b', high = '#1e5a46') +
  theme_corr +
  theme(legend.title = element_text(color = '#1e5a46'),
        legend.text = element_text(color = '#1e5a46'),
        legend.position = 'top',
        legend.justification = 'left') +
  labs(title = 'XY Heatmap',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r xy_heatmap print, echo=FALSE, out.width = "100%"}
xy_heatmap
```

***

## **Peringkat**

Tipe grafik-peringkat digunakan untuk mengurutkan variabel berdasarkan nilai tertentu yang dimiliki masing-masing variabel.

***

### Ordered Bar

```{r ordered bar}

ordered_bar <- main_df %>%
  group_by(Variable) %>%
  summarise(number_of_data = n()) %>%
  ggplot(aes(x = reorder(Variable, -number_of_data),
             y = number_of_data,
             color = reorder(Variable, -number_of_data),
             fill = reorder(Variable, -number_of_data))) +
  geom_col(width = .6) +
  scale_color_manual(values = palette_ranking,
                     guide = 'none') +
  scale_fill_manual(values = palette_ranking,
                    guide = 'none') +
  theme_ranking +
  xlab('Variable') +
  ylab('number of data') +
  labs(title = 'Ordered Bar',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r ordered bar print, echo=FALSE, out.width = "100%"}
ordered_bar
```

***

### Ordered Column

```{r ordered column}

ordered_column <- main_df %>%
  group_by(Variable) %>%
  summarise(number_of_data = n()) %>%
  ggplot(aes(x = number_of_data,
             y = reorder(Variable, number_of_data),
             color = reorder(Variable, -number_of_data),
             fill = reorder(Variable, -number_of_data))) +
  geom_col(width = .6) +
  scale_color_manual(values = palette_ranking,
                     guide = 'none') +
  scale_fill_manual(values = palette_ranking,
                    guide = 'none') +
  theme_ranking +
  xlab('number of data') +
  ylab('Variable') +
  labs(title = 'Ordered Column',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r ordered column print, echo=FALSE, out.width = "100%"}
ordered_column
```

***

### Ordered Proportional Symbol

```{r ordered prop symbol}

ordered_prop_symbol <- main_df %>%
  group_by(Variable) %>%
  summarise(number_of_data = n()) %>%
  ggplot(aes(x = reorder(Variable, -number_of_data),
             y = 0,
             color = reorder(Variable, -number_of_data),
             fill = reorder(Variable, -number_of_data))) +
  geom_point(aes(size = number_of_data), show.legend = FALSE) +
  geom_text(aes(label = Variable),
            size = 7,
            color = 'white') +
  scale_size_area(max_size = 40) +
  scale_color_manual(values = palette_ranking,
                     guide = 'none') +
  scale_fill_manual(values = palette_ranking,
                    guide = 'none') +
  scale_y_continuous(limits = c(-1,1)) +
  theme_ranking +
  theme(axis.title = element_blank(),
        axis.text = element_blank()) +
  labs(title = 'Ordered Proportional Symbol',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r ordered prop symbol print, echo=FALSE, out.width = "100%"}
ordered_prop_symbol
```

***

### Dot Strip Plot

```{r ranking dot strip plot}

rank_dot_strip_plot <- df_for_rank_dotstrip %>%
  ggplot(aes(x = value,
             y = year,
             color = year,
             fill = year)) +
  geom_point(alpha = .7,
             size = 7) +
  geom_text(aes(label = Variable),
            size = 3,
            color = 'white') +
  stat_summary(fun = "median",
               geom = "point",
               shape = 124,
               size = 10, ) + 
  scale_color_manual(values = palette_ranking,
                     guide = 'none') +
  scale_fill_manual(values = palette_ranking,
                    guide = 'none') +
  theme_ranking +
  theme(
    axis.title.y = element_blank()
    ) +
  labs(title = 'Dot Strip Plot',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r ranking dot strip plot print, echo=FALSE, out.width = "100%"}
rank_dot_strip_plot
```

***

### Ordered Dot Strip Plot

Variabel pada dot strip plot juga dapat diurutkan sesuai dengan nilai tertentu. Pada contoh dibawah, Variabel diurutkan berdasarkan nilai maksimal dari masing-masing variabel.

```{r ordered dot strip plot}

ordered_dot_strip_plot <- main_df %>%
  ggplot(aes(x = reorder(Variable, -value),
             y = value,
             color = reorder(Variable, -value),
             fill = reorder(Variable, -value))) +
  geom_point(alpha = .5, size = 5) +
  scale_color_manual(values = palette_ranking,
                     guide = 'none') +
  scale_fill_manual(values = palette_ranking,
                    guide = 'none') +
  scale_y_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  stat_summary(fun = 'max',
               geom = "text",
               label = "max",
               size = 5,
               vjust = -1) + 
  theme_ranking +
  xlab('Variable') +
  labs(title = 'Ordered Dot Strip Plot',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r ordered dot strip plot print, echo=FALSE, out.width = "100%"}
ordered_dot_strip_plot
```

***

### Slope Graph

```{r slope graph}

slope_graph <- CGPfunctions::newggslopegraph(
  dataframe = df_for_slope,
  Times = year,
  Measurement = val,
  Grouping = var,
  Title = 'Slope Graph',
  SubTitle = '2010 - 2015 - 2020',
  Caption = 'visualization by PanggahDPutra, 2022',
  XTextSize = 12,
  YTextSize = 4,
  TitleTextSize = 14,
  SubTitleTextSize = 10,
  CaptionTextSize = 8,
  TitleJustify = "center",
  SubTitleJustify = "center",
  CaptionJustify = "right",
  LineThickness = 1.2,
  LineColor = palette_ranking,
  DataTextSize = 5,
  DataTextColor = '#8d1c06',
  DataLabelPadding = 0.1,
  DataLabelFillColor = '#ffffff',
  WiderLabels = TRUE) +
  theme(plot.title = element_text(color = '#3c0d03'),
        plot.subtitle = element_text(color = '#3c0d03'),
        plot.caption = element_text(color = '#3c0d03'),
        panel.background = element_rect(fill = '#ffffff',
                                        color = NA),
        plot.background = element_rect(fill = '#ffffff',
                                       color = 'lightblue')) 

```

```{r slope graph print, echo=FALSE, out.width = "100%"}
slope_graph
```

***

### Lollipop

Pada grafik lollipop, perbedaan nilai antar variabel susah untuk dilihat jika selisih nilai tiap variabel sangat tipis. Untuk itu, nilai variabel lebih baik ditampilkan  di dalam lingkaran lollipop.

```{r lollipop}

lollipop <- main_df %>%
  group_by(Variable) %>%
  summarise(number_of_data = n()) %>%
  ggplot(aes(x = reorder(Variable, -number_of_data),
             y = number_of_data,
             color = Variable,
             fill = Variable)) +
  geom_col(alpha = 1,
           width = .05,
           color = '#3c0d03',
           fill = '#3c0d03',
           show.legend = FALSE) +
  geom_point(alpha = 1,
             size = 24,
             color = '#ed9b49',
             show.legend = FALSE) +
  geom_point(alpha = 1,
             size = 21,
             color = '#e67424',
             show.legend = FALSE) +
  geom_point(alpha = 1,
             size = 18,
             color = '#8d1c06',
             show.legend = FALSE) +
  geom_point(alpha = 1,
             size = 15,
             color = '#3c0d03',
             show.legend = FALSE) +
  geom_text(aes(label = number_of_data), 
            size = 5,
            color = '#f5c34d') +
  scale_y_continuous(limits = c(0,35)) +
  theme_ranking +
  theme(axis.text.y = element_blank()) +
  xlab('Variable') +
  ylab('number of data') +
  labs(title = 'Lollipop',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r lollipop print, echo=FALSE, out.width = "100%"}
lollipop
```

***

### Bump Chart

```{r bump chart}

bump <- df_for_bump %>%
  ggplot(aes(x = game,
             y = position,
             color = team)) +
  ggbump::geom_bump(size = 3,
                    smooth = 20,
                    show.legend = FALSE) +
  geom_point(size = 7) +
  geom_text(aes(label = position),
            size = 4,
            color = 'white') +
  geom_text(data = df_for_bump %>% filter(game == min(game)),
            aes(x = game - .1,
                label = team),
            size = 5,
            hjust = 1) +
  geom_text(data = df_for_bump %>% filter(game == max(game)),
            aes(x = game + .1,
                label = team),
            size = 5,
            hjust = 0) +
  scale_color_manual(values = palette_ranking,
                     guide = 'none') +
  scale_y_reverse() +
  theme_ranking +
  xlab('Game-') +
  ylab('Ranking') +
  labs(title = 'Bump Chart',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r bump print, echo=FALSE, out.width = "100%"}
bump
```

***

## **Distribusi**

Tipe grafik-distribusi digunakan untuk menunjukkan distribusi data dari suatu dataset atau dari tiap variabel.

***

### Histogram

```{r histogram, message=FALSE, warning=FALSE}

histogram <- main_df %>%
  ggplot(aes(x = value)) +
  geom_histogram(bins = 25,
                 alpha = .9,
                 fill = '#178f92',
                 color = '#175f5d') +
  scale_x_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  scale_y_continuous(limits = c(0,15),
                     breaks = c(0,5,10,15)) +
  theme_distr +
  ylab('number of data') +
  labs(title = 'Histogram',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r histograms print, echo=FALSE, out.width = "100%"}
histogram
```

***

### Dot Plot (Dumbbell Plot)

```{r dumbbell plot}

dumbbell_plot <- main_df %>%
  group_by(Variable) %>%
  summarise(min = min(value), max = max(value)) %>%
  ggplot(aes(x = min,
             xend = max,
             y = Variable,
             color = Variable,
             fill = Variable), ) +
  ggalt::geom_dumbbell(size =3,
                       size_x = 12,
                       size_xend = 12,
                       color = '#d8c29d',
                       colour_x = '#d8c29d',
                       colour_xend = '#d8c29d') +
  ggalt::geom_dumbbell(size = 3,
                       size_x = 9,
                       size_xend = 9,
                       color = '#d8c29d',
                       colour_x = '#4e3910',
                       colour_xend = '#175f5d') +
  geom_text(aes(x = min,
                y = Variable,
                label = round(min, 1)), 
            size = 3,
            color = 'white') +
  geom_text(aes(x = max,
                y = Variable,
                label = round(max, 1)), 
            size = 3,
            color = 'white') +
  scale_color_manual(values = palette_distr,
                     guide = 'none') +
  scale_fill_manual(values = palette_distr,
                    guide = 'none') +
  scale_x_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  xlab('min <<<value>>> max') +
  labs(title = 'Dot Plot (Dumbbell Plot)',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r dumbbell plot print, echo=FALSE, out.width = "100%"}
dumbbell_plot
```

***

### Dot Strip Plot

```{r dot strip plot}

dot_strip_plot <- main_df %>%
  ggplot(aes(x = Variable,
             y = value,
             color = Variable,
             fill = Variable)) +
  geom_point(alpha = .5, size = 5) +
  scale_color_manual(values = palette_distr,
                     guide = 'none') +
  scale_fill_manual(values = palette_distr,
                    guide = 'none') +
  scale_y_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  labs(title = 'Dot Strip Plot',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r dot strip plot print, echo=FALSE, out.width = "100%"}
dot_strip_plot
```

***

### Stat Dot Plot

Pada dot strip plot di atas, jumlah data yang memiliki nilai sama/hampir sama - sulit untuk diidentifikasi. Untuk mempermudah identifikasi, kita dapat membuat stat dot plot seperti di bawah ini.

```{r stat dot plot}

stat_dot_plot <- main_df %>%
  ggplot(aes(x = Variable,
             y = value,
             color = Variable,
             fill = Variable)) +
  ggdist::stat_dots(side = 'right') +
  scale_color_manual(values = palette_distr,
                     guide = 'none') +
  scale_fill_manual(values = palette_distr,
                    guide = 'none') +
  scale_y_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  labs(title = 'Stat Dot Plot',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r stat dot plot print, echo=FALSE, out.width = "100%"}
stat_dot_plot
```

***

### Barcode Plot

```{r barcode plot}

barcode_plot <- main_df %>%
  ggplot(aes(x = Variable,
             y = value,
             color = Variable,
             fill = Variable)) +
  geom_point(shape = 95,
             size = 25,
             alpha = .7) +
  scale_color_manual(values = palette_distr,
                     guide = 'none') +
  scale_fill_manual(values = palette_distr,
                    guide = 'none') +
  scale_y_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  labs(title = 'Barcode Plot',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r barcode plot print, echo=FALSE, out.width = "100%"}
barcode_plot
```

***

### Box Plot

```{r box plot}

box_plot <- main_df %>%
  ggplot(aes(x = Variable,
             y = value,
             color = Variable,
             fill = Variable)) +
  geom_boxplot(alpha = .7,
               size = .5,
               outlier.size = 2) +
  scale_color_manual(values = palette_distr,
                     guide = 'none') +
  scale_fill_manual(values = palette_distr,
                    guide = 'none') +
  scale_y_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  labs(title = 'Box Plot',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r box plot print, echo=FALSE, out.width = "100%"}
box_plot
```

***

### Violin Plot

```{r violin plot}

violin_plot <- main_df %>%
  ggplot(aes(x = Variable,
             y = value,
             color = Variable,
             fill = Variable)) +
  geom_violin(size = .5,
              bw = .25) +
  scale_color_manual(values = palette_distr,
                     guide = 'none') +
  scale_fill_manual(values = palette_distr,
                    guide = 'none') +
  scale_y_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  labs(title = 'Violin Plot',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r violin plot print, echo=FALSE, out.width = "100%"}
violin_plot
```

***

### Population Pyramid

```{r pop pyramid female side}

female_side <- df_for_pop_pyramid %>%
  filter(gender == 'Female') %>%
  ggplot(aes(x = value,
             y = reorder(age, desc(age)),
             fill = gender)) +
  geom_col(fill = '#178f92') +
  geom_text(aes(label = value),
            hjust = 2,
            color = 'white') +
  scale_x_continuous(limits = c(0, 50)) +
  theme_minimal() +
  theme(
    plot.title.position = "plot",
    plot.subtitle = element_text(color = '#4fb6ca',
                                 face = 'bold'),
    axis.title.x = element_text(color = '#1d1f54',
                                face = 'bold'),
    axis.title.y = element_blank(),
    axis.text.x = element_blank(),
    axis.text.y = element_text(color = '#4fb6ca',
                               face = 'bold'),
    panel.background = element_rect(fill = '#FFFCDE',
                                    color = NA),
    plot.background = element_rect(fill = '#FFFCDE',
                                   color = '#FFFCDE')
  ) +
  xlab('Female') +
  labs(subtitle = 'Age')

```

```{r pop pyramid male side}

male_side <- df_for_pop_pyramid %>%
  filter(gender == 'Male') %>%
  ggplot(aes(x = -value,
             y = reorder(age, desc(age)),
             fill = gender)) +
  geom_col(fill = '#845d29') +
  geom_text(aes(label = value),
            hjust = -1,
            color = 'white') +
  scale_x_continuous(limits = c(-50, 0)) +
  theme_minimal() +
  theme(
    axis.title.x = element_text(color = '#1d1f54',
                                face = 'bold'),
    axis.title.y = element_blank(),
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    panel.background = element_rect(fill = '#FFFCDE',
                                    color = NA),
    plot.background = element_rect(fill = '#FFFCDE',
                                   color = '#FFFCDE')
  ) +
  xlab('Male')

```

```{r pop pyramid}

pop_pyramid <- (male_side|female_side) +
  patchwork::plot_annotation(
    title = "Population Pyramid",
    caption = 'visualization by PanggahDPutra, 2022',
    theme = theme(
      plot.title = element_text(color = '#1d1f54',
                                hjust = 0.5,
                                face = 'bold'),
      plot.caption = element_text(color = '#1d1f54',
                                  hjust = 1),
      panel.background = element_rect(fill = '#FFFCDE',
                                      color = NA),
      plot.background = element_rect(fill = '#FFFCDE',
                                     color = 'lightblue')))

```

```{r pop pyramid print, echo=FALSE, out.width = "100%"}
pop_pyramid
```


***

### Cumulative Curve 

```{r cum curve}

cumulative_curve <- df_for_cum_curve %>%
  ggplot(aes(x = year,
             y = cumulative_val,
             group = var,
             color = var)) +
  geom_smooth(size = 1.5,
              se = FALSE) +
  geom_text(data = subset(df_for_cum_curve,year == '2022'),
            aes(label = var),
            hjust = -1) +
  scale_color_manual(values = c('#d8c29d', '#4fb6ca'),
                     guide = 'none') +
  scale_y_continuous(limits = c(0,500)) +
  theme_distr +
  ylab('cumulative value') +
  labs(title = 'Cumulative Curve',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r cum curve print, echo=FALSE, message=FALSE, out.width = "100%"}
cumulative_curve
```

***

### Frequency Polygons 

```{r freq poly}

freq_polygons <- main_df %>%
  ggplot(aes(x = value)) +
  geom_freqpoly(bins = 25,
                size = 1.5,
                color = '#4fb6ca') +
  scale_x_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  scale_y_continuous(limits = c(0,15),
                     breaks = c(0,5,10,15)) +
  theme_distr +
  ylab('frequency') +
  labs(title = 'Frequency Polygons',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r freq poly print, echo=FALSE, out.width = "100%"}
freq_polygons
```

***

### Beeswarm

```{r beeswarm}

beeswarm <- main_df %>%
  ggplot(aes(x = Variable,
             y = value,
             color = Variable,
             fill = Variable)) +
  ggbeeswarm::geom_beeswarm(alpha = .7,
                            size = 8,
                            cex = 3.5,
                            show.legend = FALSE) +
  scale_color_manual(values = palette_distr,
                     guide = 'none') +
  scale_fill_manual(values = palette_distr,
                    guide = 'none') +
  scale_y_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  labs(title = 'Beeswarm',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r beeswarm print, echo=FALSE, out.width = "100%"}
beeswarm
```

***

### Density Plot

Density plot menampilkan *density* dari suatu dataset.

```{r density plot}

density_plot <- main_df %>%
  ggplot(aes(x = value)) +
  geom_density(alpha = 0.9,
               fill = '#845d29',
               color = '#4e3910') +
  scale_x_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  ylab('density') +
  labs(title = 'Density Plot',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r density plot print, echo=FALSE, out.width = "100%"}
density_plot
```

***

### Stat Density Ridges Plot

Tidak seperti density plot, stat density plot menampilkan *density* dari tiap variabel. Stat density plot juga dapat menampilkan nilai quantile dari tiap variabel. Pada stat dot plot di bawah, nilai quantile yang ditampilkan adalah Q2 (median).

```{r stat density ridges plot}

stat_density_ridges_plot <- main_df %>%
  ggplot(aes(x = value,
             y = Variable,
             fill = Variable,
             color = Variable)) +
  ggridges::stat_density_ridges(quantile_lines = TRUE,
                                quantiles = 2,
                                alpha = .5,
                                size = .8,
                                rel_min_height = 0.01) +
  scale_color_manual(values = palette_distr,
                     guide = 'none') +
  scale_fill_manual(values = palette_distr,
                    guide = 'none') +
  scale_x_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  labs(title = 'Stat Density Ridges Plot',
       subtitle = '',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r stat density ridges plot print, echo=FALSE, message=FALSE, out.width = "100%"}
stat_density_ridges_plot
```

***

## **Referensi**

* [Visual Vocabulary](https://github.com/Financial-Times/chart-doctor/tree/main/visual-vocabulary){target="blank"}
  
* [tidyverse](https://tidyverse.tidyverse.org/){target="blank"}
  
* [CGPfunctions](https://github.com/ibecav/CGPfunctions){target="blank"}
  
* [ggbump](https://github.com/davidsjoberg/ggbump){target="blank"}
  
* [ggalt](https://github.com/hrbrmstr/ggalt){target="blank"}
  
* [ggdist](https://github.com/mjskay/ggdist/){target="blank"}
  
* [ggbeeswarm](https://github.com/eclarke/ggbeeswarm){target="blank"}
  
* [patchwork](https://github.com/thomasp85/patchwork){target="blank"}

* [ggridges](https://wilkelab.org/ggridges/){target="blank"}
  
* [MetBrewer](https://github.com/BlakeRMills/MetBrewer){target="blank"}
    
* [flipbook_script.R](https://osf.io/vt2ny/){target="blank"}
  
* [Beyond Bar and Box Plots](https://z3tt.github.io/beyond-bar-and-box-plots){target="blank"}