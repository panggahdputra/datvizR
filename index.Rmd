---
title: "**Data Visualization with R**"
subtitle: "Hands-on code to create various charts <br> with R Programming Language"
author: "*Author : Panggah D. Putra*"
date: "*Last update : `r format(Sys.time(), '%d %B %Y')`*"
output:
  html_document:
    toc: true
    toc_float: true
#      collapsed: false
    toc_depth: 3
#    number_sections: true
    theme: lumen
    highlight: tango
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
```

***
## **Preface**

This website is under development.

***

##### Chart Classification

Classification of the charts in this website is based on the [Financial Times visual vocabulary](https://github.com/Financial-Times/chart-doctor/tree/main/visual-vocabulary){target="blank"} with addition of other resources.

***

##### Color Palettes

Color palettes we used above is come from [MetBrewer](https://github.com/BlakeRMills/MetBrewer){target="blank"}. 

***

##### Datasets

Inspiration of the *main_df* above is come from [flipbook_script.R](https://osf.io/vt2ny/){target="blank"} that mentioned by CÃ©dric Scherer on his [Beyond Bar and Box Plots](https://z3tt.github.io/beyond-bar-and-box-plots/#import-data){target="blank"}.

*******

## **Prerequisites**

### Load Packages

Before we dive into plotting, load the packages we need first.

```{r, message=FALSE}

library(tidyverse)    # for data wrangling and making plots with ggplot2
library(CGPfunctions) # to makes Slope Graph
library(ggbump)       # to makes Bump Chart
library(ggalt)        # to makes Dumbbell Plot
library(ggdist)       # to makes Stat Dot Plot
library(ggbeeswarm)   # to makes Beeswarm Plot
library(patchwork)    # to makes annotation on Population Pyramid

```

***

### Prepare Datasets

We use various kind of datasets.
Majority of the plots use *main_df*.

```{r main df}

set.seed(2000)
df1 = tibble(var = 'A', val = rnorm(n = 25, mean = 5.5, sd = 1.5))
df2 = tibble(var = 'B', val = rnorm(n = 15, mean = 4.5, sd = 1.0))
df3 = tibble(var = 'C', val = rnorm(n = 20, mean = 5.0, sd = 1.0))
df4 = tibble(var = 'D', val = rnorm(n = 10, mean = 4.0, sd = 0.5))
df5 = tibble(var = 'E', val = rnorm(n = 13, mean = 5.0, sd = 1.5))

main_df <- rbind(df1, df2, df3, df4, df5) %>%
  mutate(Variable = as_factor(var),
         value = round(val, 2)) %>%
  select(Variable, value)

```

To make the bump chart, we use *df_for_bump*.

```{r df for bump}

set.seed(2021)
df_6 = tibble(team = c('A','B','C','D','E'),
              game_1 = sample(1:5),
              game_2 = sample(1:5),
              game_3 = sample(1:5),
              game_4 = sample(1:5),
              game_5 = sample(1:5))

df_for_bump <- df_6 %>%
  pivot_longer(!team, names_to = 'game', values_to = 'position') %>%
  mutate(game = as.numeric(recode(game,
                                  game_1 = 1,
                                  game_2 = 2,
                                  game_3 = 3,
                                  game_4 = 4,
                                  game_5 = 5)))

```

To make the slope graph, we use *df_for_slope*.

```{r df for slope}

df_for_slope = tibble(var = c('A','B','C','D', 'E',
                              'A','B','C','D', 'E',
                              'A','B','C','D', 'E'),
                     year = c('2010','2010','2010','2010','2010',
                               '2015','2015','2015','2015','2015',
                               '2020','2020','2020','2020','2020'),
                     val = c(10,8,6,4,2,
                             13,9,11,5,7,
                             12,13,9,7,5))

```

***

To make the population pyramid, we use *df_for_pop_pyramid*.

```{r df for pop pyramid}

set.seed(2000)
df1 = tibble(gender = 'Male', age = '15-20',
             value = sample((5:10), size = 1))
df2 = tibble(gender = 'Male', age = '21-25',
             value = sample((10:15), size = 1))
df3 = tibble(gender = 'Male', age = '26-30',
             value = sample((15:20), size = 1))
df4 = tibble(gender = 'Male', age = '31-35',
             value = sample((20:25), size = 1))
df5 = tibble(gender = 'Male', age = '36-40',
             value = sample((25:30), size = 1))
df6 = tibble(gender = 'Male', age = '41-45',
             value = sample((30:35), size = 1))
df7 = tibble(gender = 'Male', age = '46-50',
             value = sample((35:40), size = 1))
df8 = tibble(gender = 'Male', age = '51-55',
             value = sample((40:45), size = 1))
df9 = tibble(gender = 'Male', age = '56-60',
             value = sample((45:50), size = 1))
df10 = tibble(gender = 'Female', age = '15-20',
              value = sample((5:10), size = 1))
df11 = tibble(gender = 'Female', age = '21-25',
              value = sample((10:15), size = 1))
df12 = tibble(gender = 'Female', age = '26-30',
              value = sample((15:20), size = 1))
df13 = tibble(gender = 'Female', age = '31-35',
              value = sample((20:25), size = 1))
df14 = tibble(gender = 'Female', age = '36-40',
              value = sample((25:30), size = 1))
df15 = tibble(gender = 'Female', age = '41-45',
              value = sample((30:35), size = 1))
df16 = tibble(gender = 'Female', age = '46-50',
              value = sample((35:40), size = 1))
df17 = tibble(gender = 'Female', age = '51-55',
              value = sample((40:45), size = 1))
df18 = tibble(gender = 'Female', age = '56-60',
              value = sample((45:50), size = 1))

df_for_pop_pyramid <- rbind(df1, df2, df3, df4, df5, df6,
                            df7,df8, df9, df10, df11, df12,
                            df13, df14, df15, df16, df17, df18) %>%
  mutate(age = as.factor(age))

```

***

```{r}

set.seed(123)
df_for_cum_curve = tibble(
  var = c('A', 'A', 'A', 'A', 'A', 'A', 'A', 'A',
          'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B'),
  year = c('2015', '2016', '2017', '2018',
           '2019', '2020', '2021', '2022',
           '2015', '2016', '2017', '2018',
           '2019', '2020', '2021', '2022'),
  val = c(sample(10:50, size = 4, replace = TRUE),
          sample(50:100, size = 4, replace = TRUE),
          sample(10:50, size = 4, replace = TRUE),
          sample(50:100, size = 4, replace = TRUE)))

df_for_cum_curve <- df_for_cum_curve %>%
  group_by(var) %>%
  mutate(cumulative_val = cumsum(val))

```

***

### Prepare Color Palettes

We use different color palette for each chart type. To styling ranking chart type, we use *palette_ranking*. I copy the hex color code manually form *Greek Palette* on [MetBrewer](https://github.com/BlakeRMills/MetBrewer#greek){target="blank"}.

```{r palette for ranking}

palette_ranking <- c('#3c0d03',
                     '#8d1c06',
                     '#e67424',
                     '#ed9b49',
                     '#f5c34d')

```

To styling distribution chart type, we use *palette_distr*. I copy the hex color code manually form *Isfahan1 Palette* on [MetBrewer](https://github.com/BlakeRMills/MetBrewer#isfahan1){target="blank"}.

```{r palette for distribution}

palette_distr <-c('#4e3910',
                  '#845d29',
                  '#4fb6ca',
                  '#178f92',
                  '#175f5d')

```

***

### Prepare Themes

We use different theme for each chart type.
To styling ranking chart type, we use *theme_ranking*.

```{r theme for rangking}

theme_ranking <- theme_minimal() +
  theme(
    plot.title = element_text(color = '#3c0d03',
                              hjust = 0.5,
                              face = 'bold'),
    plot.subtitle = element_text(color = '#3c0d03',
                                 hjust = 0.5),
    plot.caption = element_text(color = '#3c0d03',
                                hjust = 1),
    axis.title = element_text(color = '#8d1c06',
                              face = 'bold'),
    axis.text = element_text(color = '#8d1c06',
                             face = 'bold'),
    panel.background = element_rect(fill = '#ffffff',
                                    color = NA),
    plot.background = element_rect(fill = '#ffffff',
                                   color = 'lightblue')
  )

```

To styling distribution chart type, we use *theme_distr*.

```{r theme for distribution}

theme_distr <- theme_minimal() +
  theme(
    plot.title = element_text(color = '#1d1f54',
                              hjust = 0.5,
                              face = 'bold'),
    plot.subtitle = element_text(color = '#1d1f54',
                                 hjust = 0.5),
    plot.caption = element_text(color = '#1d1f54',
                                hjust = 1),
    axis.title = element_text(color = '#1d1f54',
                              face = 'bold'),
    axis.text = element_text(color = '#1d1f54',
                             face = 'bold'),
    panel.background = element_rect(fill = '#FFFCDE',
                                    color = NA),
    plot.background = element_rect(fill = '#FFFCDE',
                                   color = 'lightblue')
  )

```

***

## **Ranking**

Ranking chart type use to show ordered categorical variable by its value.

### Ordered Bar

```{r ordered bar}

ordered_bar <- main_df %>%
  group_by(Variable) %>%
  summarise(number_of_data = n()) %>%
  ggplot(aes(x = reorder(Variable, -number_of_data),
             y = number_of_data,
             color = reorder(Variable, -number_of_data),
             fill = reorder(Variable, -number_of_data))) +
  geom_col(width = .6) +
  scale_color_manual(values = palette_ranking,
                     guide = 'none') +
  scale_fill_manual(values = palette_ranking,
                    guide = 'none') +
  theme_ranking +
  xlab('Variable') +
  ylab('number of data') +
  labs(title = 'Ordered Bar',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r ordered bar print, echo=FALSE, out.width = "100%"}
ordered_bar
```

***

### Ordered Column

```{r ordered column}

ordered_column <- main_df %>%
  group_by(Variable) %>%
  summarise(number_of_data = n()) %>%
  ggplot(aes(x = number_of_data,
             y = reorder(Variable, number_of_data),
             color = reorder(Variable, -number_of_data),
             fill = reorder(Variable, -number_of_data))) +
  geom_col(width = .6) +
  scale_color_manual(values = palette_ranking,
                     guide = 'none') +
  scale_fill_manual(values = palette_ranking,
                    guide = 'none') +
  theme_ranking +
  xlab('number of data') +
  ylab('Variable') +
  labs(title = 'Ordered Column',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r ordered column print, echo=FALSE, out.width = "100%"}
ordered_column
```

***

### Ordered Proportional Symbol

```{r ordered prop symbol}

ordered_prop_symbol <- main_df %>%
  group_by(Variable) %>%
  summarise(number_of_data = n()) %>%
  ggplot(aes(x = reorder(Variable, -number_of_data),
             y = 0,
             color = reorder(Variable, -number_of_data),
             fill = reorder(Variable, -number_of_data))) +
  geom_point(aes(size = number_of_data), show.legend = FALSE) +
  geom_text(aes(label = Variable),
            size = 7,
            color = 'white') +
  scale_size_area(max_size = 40) +
  scale_color_manual(values = palette_ranking,
                     guide = 'none') +
  scale_fill_manual(values = palette_ranking,
                    guide = 'none') +
  scale_y_continuous(limits = c(-1,1)) +
  theme_ranking +
  theme(axis.title = element_blank(),
        axis.text = element_blank()) +
  labs(title = 'Ordered Proportional Symbol',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r ordered prop symbol print, echo=FALSE, out.width = "100%"}
ordered_prop_symbol
```

***

### Ordered Dot Strip Plot

In this example, we ordered dot strip plot by max value of each variable.

```{r ordered dot strip plot}

ordered_dot_strip_plot <- main_df %>%
  ggplot(aes(x = reorder(Variable, -value),
             y = value,
             color = reorder(Variable, -value),
             fill = reorder(Variable, -value))) +
  geom_point(alpha = .5, size = 5) +
  scale_color_manual(values = palette_ranking,
                     guide = 'none') +
  scale_fill_manual(values = palette_ranking,
                    guide = 'none') +
  scale_y_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  stat_summary(fun = 'max',
               geom = "text",
               label = "max",
               size = 5,
               vjust = -1) + 
  theme_ranking +
  xlab('Variable') +
  labs(title = 'Ordered Dot Strip Plot',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r ordered dot strip plotg print, echo=FALSE, out.width = "100%"}
ordered_dot_strip_plot
```

***

### Slope Graph

```{r slope graph}

slope_graph <- CGPfunctions::newggslopegraph(
  dataframe = df_for_slope,
  Times = year,
  Measurement = val,
  Grouping = var,
  Title = 'Slope Graph',
  SubTitle = '2010 - 2015 - 2020',
  Caption = 'visualization by PanggahDPutra, 2022',
  XTextSize = 12,
  YTextSize = 4,
  TitleTextSize = 14,
  SubTitleTextSize = 10,
  CaptionTextSize = 8,
  TitleJustify = "center",
  SubTitleJustify = "center",
  CaptionJustify = "right",
  LineThickness = 1.2,
  LineColor = palette_ranking,
  DataTextSize = 5,
  DataTextColor = '#8d1c06',
  DataLabelPadding = 0.1,
  DataLabelFillColor = '#ffffff',
  WiderLabels = TRUE) +
  theme(plot.title = element_text(color = '#3c0d03'),
        plot.subtitle = element_text(color = '#3c0d03'),
        plot.caption = element_text(color = '#3c0d03'),
        panel.background = element_rect(fill = '#ffffff',
                                        color = NA),
        plot.background = element_rect(fill = '#ffffff',
                                       color = 'lightblue')) 

```

```{r slope graph print, echo=FALSE, out.width = "100%"}
slope_graph
```

***

### Lollipop

Since lollipop chart is harder to interpret, we better show the data value.

```{r lollipop}

lollipop <- main_df %>%
  group_by(Variable) %>%
  summarise(number_of_data = n()) %>%
  ggplot(aes(x = reorder(Variable, -number_of_data),
             y = number_of_data,
             color = Variable,
             fill = Variable)) +
  geom_col(alpha = 1,
           width = .05,
           color = '#3c0d03',
           fill = '#3c0d03',
           show.legend = FALSE) +
  geom_point(alpha = 1,
             size = 24,
             color = '#ed9b49',
             show.legend = FALSE) +
  geom_point(alpha = 1,
             size = 21,
             color = '#e67424',
             show.legend = FALSE) +
  geom_point(alpha = 1,
             size = 18,
             color = '#8d1c06',
             show.legend = FALSE) +
  geom_point(alpha = 1,
             size = 15,
             color = '#3c0d03',
             show.legend = FALSE) +
  geom_text(aes(label = number_of_data), 
            size = 5,
            color = '#f5c34d') +
  scale_y_continuous(limits = c(0,35)) +
  theme_ranking +
  theme(axis.text.y = element_blank()) +
  xlab('Variable') +
  ylab('number of data') +
  labs(title = 'Lollipop',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r lollipop print, echo=FALSE, out.width = "100%"}
lollipop
```

***

### Bump Chart

```{r bump chart}

bump <- df_for_bump %>%
  ggplot(aes(x = game,
             y = position,
             color = team)) +
  ggbump::geom_bump(size = 3,
                    smooth = 20,
                    show.legend = FALSE) +
  geom_point(size = 7) +
  geom_text(aes(label = position),
            size = 4,
            color = 'white') +
  geom_text(data = df_for_bump %>% filter(game == min(game)),
            aes(x = game - .1,
                label = team),
            size = 5,
            hjust = 1) +
  geom_text(data = df_for_bump %>% filter(game == max(game)),
            aes(x = game + .1,
                label = team),
            size = 5,
            hjust = 0) +
  scale_color_manual(values = palette_ranking,
                     guide = 'none') +
  scale_y_reverse() +
  theme_ranking +
  xlab('Game-') +
  ylab('Ranking') +
  labs(title = 'Bump Chart',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r bump print, echo=FALSE, out.width = "100%"}
bump
```

***

## **Distribution**

### Histogram

```{r histogram, message=FALSE, warning=FALSE}

histogram <- main_df %>%
  ggplot(aes(x = value)) +
  geom_histogram(bins = 25,
                 alpha = .9,
                 fill = '#178f92',
                 color = '#175f5d') +
  scale_x_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  scale_y_continuous(limits = c(0,15),
                     breaks = c(0,5,10,15)) +
  theme_distr +
  ylab('number of data') +
  labs(title = 'Histogram',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r histograms print, echo=FALSE, out.width = "100%"}
histogram
```

***

### Dumbbell Plot

```{r dumbbell plot}

dumbbell_plot <- main_df %>%
  group_by(Variable) %>%
  summarise(min = min(value), max = max(value)) %>%
  ggplot(aes(x = min,
             xend = max,
             y = Variable,
             color = Variable,
             fill = Variable), ) +
  ggalt::geom_dumbbell(size =3,
                       size_x = 12,
                       size_xend = 12,
                       color = '#d8c29d',
                       colour_x = '#d8c29d',
                       colour_xend = '#d8c29d') +
  ggalt::geom_dumbbell(size = 3,
                       size_x = 9,
                       size_xend = 9,
                       color = '#d8c29d',
                       colour_x = '#4e3910',
                       colour_xend = '#175f5d') +
  geom_text(aes(x = min,
                y = Variable,
                label = round(min, 1)), 
            size = 3,
            color = 'white') +
  geom_text(aes(x = max,
                y = Variable,
                label = round(max, 1)), 
            size = 3,
            color = 'white') +
  scale_color_manual(values = palette_distr,
                     guide = 'none') +
  scale_fill_manual(values = palette_distr,
                    guide = 'none') +
  scale_x_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  xlab('min <<<value>>> max') +
  labs(title = 'Dot Plot (Dumbbell Plot)',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r dumbbell plot print, echo=FALSE, out.width = "100%"}
dumbbell_plot
```

***

### Dot Strip Plot

```{r dot strip plot}
dot_strip_plot <- main_df %>%
  ggplot(aes(x = Variable,
             y = value,
             color = Variable,
             fill = Variable)) +
  geom_point(alpha = .5, size = 5) +
  scale_color_manual(values = palette_distr,
                     guide = 'none') +
  scale_fill_manual(values = palette_distr,
                    guide = 'none') +
  scale_y_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  labs(title = 'Dot Strip Plot',
       caption = 'visualization by PanggahDPutra, 2022')
```

```{r dot strip plot print, echo=FALSE, out.width = "100%"}
dot_strip_plot
```

***

### Stat Dot Plot

```{r stat dot plot}

stat_dot_plot <- main_df %>%
  ggplot(aes(x = Variable,
             y = value,
             color = Variable,
             fill = Variable)) +
  ggdist::stat_dots(side = 'right') +
  scale_color_manual(values = palette_distr,
                     guide = 'none') +
  scale_fill_manual(values = palette_distr,
                    guide = 'none') +
  scale_y_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  labs(title = 'Stat Dot Plot',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r stat dot plot print, echo=FALSE, out.width = "100%"}
stat_dot_plot
```

***

### Barcode Plot

```{r barcode plot}

barcode_plot <- main_df %>%
  ggplot(aes(x = Variable,
             y = value,
             color = Variable,
             fill = Variable)) +
  geom_point(shape = 95,
             size = 25,
             alpha = .7) +
  scale_color_manual(values = palette_distr,
                     guide = 'none') +
  scale_fill_manual(values = palette_distr,
                    guide = 'none') +
  scale_y_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  labs(title = 'Barcode Plot',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r barcode plot print, echo=FALSE, out.width = "100%"}
barcode_plot
```

***

### Box Plot

```{r box plot}

box_plot <- main_df %>%
  ggplot(aes(x = Variable,
             y = value,
             color = Variable,
             fill = Variable)) +
  geom_boxplot(alpha = .7,
               size = .5,
               outlier.size = 2) +
  scale_color_manual(values = palette_distr,
                     guide = 'none') +
  scale_fill_manual(values = palette_distr,
                    guide = 'none') +
  scale_y_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  labs(title = 'Box Plot',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r box plot print, echo=FALSE, out.width = "100%"}
box_plot
```

***

### Violin Plot

```{r violin plot}

violin_plot <- main_df %>%
  ggplot(aes(x = Variable,
             y = value,
             color = Variable,
             fill = Variable)) +
  geom_violin(size = .5,
              bw = .25) +
  scale_color_manual(values = palette_distr,
                     guide = 'none') +
  scale_fill_manual(values = palette_distr,
                    guide = 'none') +
  scale_y_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  labs(title = 'Violin Plot',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r violin plot print, echo=FALSE, out.width = "100%"}
violin_plot
```

***

### Population Pyramid

```{r pop pyramid female side}

female_side <- df_for_pop_pyramid %>%
  filter(gender == 'Female') %>%
  ggplot(aes(x = value,
             y = reorder(age, desc(age)),
             fill = gender)) +
  geom_col(fill = '#178f92') +
  geom_text(aes(label = value),
            hjust = 2,
            color = 'white') +
  scale_x_continuous(limits = c(0, 50)) +
  theme_minimal() +
  theme(
    plot.title.position = "plot",
    plot.subtitle = element_text(color = '#4fb6ca',
                                 face = 'bold'),
    axis.title.x = element_text(color = '#1d1f54',
                                face = 'bold'),
    axis.title.y = element_blank(),
    axis.text.x = element_blank(),
    axis.text.y = element_text(color = '#4fb6ca',
                               face = 'bold'),
    panel.background = element_rect(fill = '#FFFCDE',
                                    color = NA),
    plot.background = element_rect(fill = '#FFFCDE',
                                   color = '#FFFCDE')
  ) +
  xlab('Female') +
  labs(subtitle = 'Age')

```

```{r pop pyramid male side}

male_side <- df_for_pop_pyramid %>%
  filter(gender == 'Male') %>%
  ggplot(aes(x = -value,
             y = reorder(age, desc(age)),
             fill = gender)) +
  geom_col(fill = '#845d29') +
  geom_text(aes(label = value),
            hjust = -1,
            color = 'white') +
  scale_x_continuous(limits = c(-50, 0)) +
  theme_minimal() +
  theme(
    axis.title.x = element_text(color = '#1d1f54',
                                face = 'bold'),
    axis.title.y = element_blank(),
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    panel.background = element_rect(fill = '#FFFCDE',
                                    color = NA),
    plot.background = element_rect(fill = '#FFFCDE',
                                   color = '#FFFCDE')
  ) +
  xlab('Male')

```

```{r pop pyramid}

pop_pyramid <- (male_side|female_side) +
  patchwork::plot_annotation(
    title = "Population Pyramid",
    caption = 'visualization by PanggahDPutra, 2022',
    theme = theme(
      plot.title = element_text(color = '#1d1f54',
                                hjust = 0.5,
                                face = 'bold'),
      plot.caption = element_text(color = '#1d1f54',
                                  hjust = 1),
      panel.background = element_rect(fill = '#FFFCDE',
                                      color = NA),
      plot.background = element_rect(fill = '#FFFCDE',
                                     color = 'lightblue')))

```

```{r pop pyramid print, echo=FALSE, out.width = "100%"}
pop_pyramid
```


***

### Cumulative Curve 

```{r cum curve}

cumulative_curve <- df_for_cum_curve %>%
  ggplot(aes(x = year,
             y = cumulative_val,
             group = var,
             color = var)) +
  geom_smooth(size = 1.5,
              se = FALSE) +
  geom_text(data = subset(df_for_cum_curve,year == '2022'),
            aes(label = var),
            hjust = -1) +
  scale_color_manual(values = c('#178f92', '#845d29'),
                     guide = 'none') +
  scale_y_continuous(limits = c(0,500)) +
  theme_distr +
  ylab('cumulative value') +
  labs(title = 'Cumulative Curve',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r cum curve print, echo=FALSE, message=FALSE, out.width = "100%"}
cumulative_curve
```

***

### Frequency Polygons 

Not done yet.

***

### Beeswarm

```{r beeswarm}

beeswarm <- main_df %>%
  ggplot(aes(x = Variable,
             y = value,
             color = Variable,
             fill = Variable)) +
  ggbeeswarm::geom_beeswarm(alpha = .7,
                            size = 8,
                            cex = 3.5,
                            show.legend = FALSE) +
  scale_color_manual(values = palette_distr,
                     guide = 'none') +
  scale_fill_manual(values = palette_distr,
                    guide = 'none') +
  scale_y_continuous(limits = c(0,10),
                     breaks = c(0,2,4,6,8,10)) +
  theme_distr +
  labs(title = 'Beeswarm',
       caption = 'visualization by PanggahDPutra, 2022')

```

```{r beeswarm print, echo=FALSE, out.width = "100%"}
beeswarm
```

***

## **Correllation**

### Scatterplot

Not done yet.

***

### Column + Line Timeline

Not done yet.

***

### Connected Scatterplot

Not done yet.

***

### Bubble

Not done yet.

***

### XY Heatmap

Not done yet.

***

## **Part to Whole**

### Stacked Column/Bar

Not done yet.

***

### Marimekko

Not done yet.

***

### Pie

Not done yet.

***

### Donut

Not done yet.

***

### Treemap

Not done yet.

***

### Voronoi

Not done yet.

***

### Arc

Not done yet.

***

### Grid Plot

Not done yet.

***

### Venn Diagram

Not done yet.

***

### Waterfall

Not done yet.

***

## **References**

  * [Visual Vocabulary](https://github.com/Financial-Times/chart-doctor/tree/main/visual-vocabulary){target="blank"}
  
  * [tidyverse](https://tidyverse.tidyverse.org/){target="blank"}
  
  * [CGPfunctions](https://github.com/ibecav/CGPfunctions){target="blank"}
  
  * [ggbump](https://github.com/davidsjoberg/ggbump){target="blank"}
  
  * [ggalt](https://github.com/hrbrmstr/ggalt){target="blank"}
  
  * [ggdist](https://github.com/mjskay/ggdist/){target="blank"}
  
  * [ggbeeswarm](https://github.com/eclarke/ggbeeswarm){target="blank"}
  
  * [patchwork](https://github.com/thomasp85/patchwork){target="blank"}
  
  * [MetBrewer](https://github.com/BlakeRMills/MetBrewer){target="blank"}
    
  * [flipbook_script.R](https://osf.io/vt2ny/){target="blank"}
  
  * [Beyond Bar and Box Plots](https://z3tt.github.io/beyond-bar-and-box-plots){target="blank"}